--- mm/page_alloc.c	2012-05-21 00:29:13.000000000 +0200
+++ mm/page_alloc.c	2014-01-08 18:42:33.000000000 +0100
@@ -5350,7 +5360,7 @@
 	pfn &= (PAGES_PER_SECTION-1);
 	return (pfn >> pageblock_order) * NR_PAGEBLOCK_BITS;
 #else
-	pfn = pfn - zone->zone_start_pfn;
+	pfn = pfn - round_down(zone->zone_start_pfn, pageblock_nr_pages);
 	return (pfn >> pageblock_order) * NR_PAGEBLOCK_BITS;
 #endif /* CONFIG_SPARSEMEM */
 }
